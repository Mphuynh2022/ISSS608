<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Huynh Minh Phuong">

<title>ISSS608-VAA - Take Home Exercise 02</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="../../site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="../../site_libs/vis-9.1.0/vis-network.min.js"></script>
<script src="../../site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608-VAA</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#data-set" id="toc-data-set" class="nav-link" data-scroll-target="#data-set">Data set</a>
  <ul class="collapse">
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link" data-scroll-target="#load-packages">Load packages</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data">Import data</a></li>
  <li><a href="#extract-node-information-for-the-main-graph" id="toc-extract-node-information-for-the-main-graph" class="nav-link" data-scroll-target="#extract-node-information-for-the-main-graph">Extract node information for the main graph</a></li>
  <li><a href="#extract-edge-information-for-the-main-graph" id="toc-extract-edge-information-for-the-main-graph" class="nav-link" data-scroll-target="#extract-edge-information-for-the-main-graph">Extract edge information for the main graph</a></li>
  <li><a href="#filter-out-irrelevant-hscode" id="toc-filter-out-irrelevant-hscode" class="nav-link" data-scroll-target="#filter-out-irrelevant-hscode">Filter out irrelevant hscode</a></li>
  <li><a href="#prepare-nodes-data" id="toc-prepare-nodes-data" class="nav-link" data-scroll-target="#prepare-nodes-data">Prepare nodes data</a></li>
  </ul></li>
  <li><a href="#data-visualization" id="toc-data-visualization" class="nav-link" data-scroll-target="#data-visualization">Data Visualization</a>
  <ul class="collapse">
  <li><a href="#visualize-the-main-graph" id="toc-visualize-the-main-graph" class="nav-link" data-scroll-target="#visualize-the-main-graph">Visualize the main graph</a></li>
  <li><a href="#temporal-analysis" id="toc-temporal-analysis" class="nav-link" data-scroll-target="#temporal-analysis">Temporal analysis</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#community-dectection" id="toc-community-dectection" class="nav-link" data-scroll-target="#community-dectection">Community Dectection</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take Home Exercise 02</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Huynh Minh Phuong </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>Overview</h1>
<p>Oceanus has enlisted FishEye International’s assistance in identifying potentially illegal fishing companies. FishEye’s analysts were provided with import/export data for Oceanus’ marine and fishing sectors, but the data was incomplete. To aid their analysis, FishEye transformed the trade data into a knowledge graph to understand business relationships, specifically to combat illegal, unreported, and unregulated (IUU) fishing and protect affected marine species. While node-link diagrams provided a high-level overview of the knowledge graph, FishEye now seeks visualizations that offer more detailed patterns about entities within the graph. The analysis consists of two main parts.</p>
<p>Firstly, FishEye aims to visualize temporal patterns to determine if companies engaging in illegal fishing activities have reemerged under different names after shutting down. They seek assistance in comparing the activities of these companies over time.</p>
<p>Secondly, FishEye has employed various tools, including artificial intelligence, to reason on the knowledge graph and propose additional links to expand the dataset. They have presented 12 groups of link suggestions and require aid in evaluating the reliability of these tools for completing the graph. FishEye is particularly interested in identifying new temporal patterns or anomalies that arise when new links are added.</p>
<p>We aim to use visual analytics to help FishEye identify companies that may be engaged in illegal fishing.</p>
</section>
<section id="data-set" class="level1">
<h1>Data set</h1>
<p>The graph is structured in a JSON format designed to align with d3’s node-link format and ensure compatibility with networkx.node_link_graph. At the top level, it consists of a dictionary containing graph-level properties, indicated by keys such as “directed,” “multigraph,” and “graph.” The “nodes” and “links” keys each hold a dictionary of nodes and links, respectively.</p>
<p>For nodes, the entries must include a unique “id” key for each node. As for links, they consist of “source” and “target” keys, referring to the node id values. Any additional keys provided within the node and link dictionaries serve as attributes for those specific nodes or links.</p>
<p>Node Attributes:</p>
<ul>
<li><p>id – Name of the company that originated (or received) the shipment</p></li>
<li><p>shpcountry – Country the company most often associated with when shipping</p></li>
<li><p>rcvcountry – Country the company most often associated with when receiving</p></li>
<li><p>dataset – Always ‘MC2’</p></li>
</ul>
<p>Edge Attributes:</p>
<ul>
<li><p>arrivaldate – Date the shipment arrived at port in YYYY-MM-DD format.</p></li>
<li><p>hscode – Harmonized System code for the shipment. Can be joined with the hscodes table to get additional details.</p></li>
<li><p>valueofgoods_omu – Customs-declared value of the total shipment, in Oceanus Monetary Units (OMU)</p></li>
<li><p>volumeteu – The volume of the shipment in ‘Twenty-foot equivalent units’, roughly how many 20-foot standard containers would be required. (Actual number of containers may have been different as there are 20ft and 40ft standard containers and tankers that do not use containers)</p></li>
<li><p>weightkg – The weight of the shipment in kilograms (if known)</p></li>
<li><p>dataset – Always ‘MC2’</p></li>
<li><p>type – Always ‘shipment’ for MC2</p></li>
<li><p>generated_by – Name of the program that generated the edge. (Only found on ‘bundle’ records.)</p></li>
</ul>
<section id="load-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-packages">Load packages</h2>
<p>The main packages for plotting graphs are: <strong>igraph, tidygraph, ggraph, visNetwork, sf, sfnetworks</strong>. The rest of the packages are for data wrangling.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(igraph,tidygraph,sf,sfnetworks,ggraph,visNetwork,sftime,ggmap,lubridate,clock,tmap,readr,ggplot2,tidyverse,graphlayouts,assertthat,purrr, jsonlite, zoo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-data" class="level2">
<h2 class="anchored" data-anchor-id="import-data">Import data</h2>
<p>Use <code>fromJson</code> from package <strong>jsonlite</strong> to import main graph data from json file format</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>MC2<span class="ot">&lt;-</span><span class="fu">fromJSON</span>(<span class="st">"data/mc2_challenge_graph.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Import bundle data. Each bundle represents the output of an AI program for link inference. Each bundle represents a list of potential edges to add to the main graph. The challenge is to decide WHICH of these bundles should be used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>carp<span class="ot">&lt;-</span><span class="fu">fromJSON</span>(<span class="st">"data/bundles/carp.json"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>catfish<span class="ot">&lt;-</span><span class="fu">fromJSON</span>(<span class="st">"data/bundles/catfish.json"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>chub_mackerel<span class="ot">&lt;-</span><span class="fu">fromJSON</span>(<span class="st">"data/bundles/chub_mackerel.json"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>cod<span class="ot">&lt;-</span><span class="fu">fromJSON</span>(<span class="st">"data/bundles/cod2.json"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>herring<span class="ot">&lt;-</span><span class="fu">fromJSON</span>(<span class="st">"data/bundles/herring.json"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>lichen<span class="ot">&lt;-</span><span class="fu">fromJSON</span>(<span class="st">"data/bundles/lichen.json"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>mackerel<span class="ot">&lt;-</span><span class="fu">fromJSON</span>(<span class="st">"data/bundles/mackerel.json"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>pollock<span class="ot">&lt;-</span><span class="fu">fromJSON</span>(<span class="st">"data/bundles/pollock.json"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>salmon<span class="ot">&lt;-</span><span class="fu">fromJSON</span>(<span class="st">"data/bundles/salmon.json"</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>salmon_wgl<span class="ot">&lt;-</span><span class="fu">fromJSON</span>(<span class="st">"data/bundles/salmon_wgl.json"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>shark<span class="ot">&lt;-</span><span class="fu">fromJSON</span>(<span class="st">"data/bundles/shark.json"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>tuna<span class="ot">&lt;-</span><span class="fu">fromJSON</span>(<span class="st">"data/bundles/tuna.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="extract-node-information-for-the-main-graph" class="level2">
<h2 class="anchored" data-anchor-id="extract-node-information-for-the-main-graph">Extract node information for the main graph</h2>
<p>We will ignore the <em>dataset</em> column and use <code>select</code> to select <em>id, shipping country and receiving country</em> information. Use <code>glimpse</code> to view the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>MC2_nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC2<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, shpcountry,rcvcountry)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(MC2_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 34,576
Columns: 3
$ id         &lt;chr&gt; "AquaDelight Inc and Son's", "BaringoAmerica Marine Ges.m.b…
$ shpcountry &lt;chr&gt; "Polarinda", NA, "Oceanus", NA, "Oceanus", "Kondanovia", NA…
$ rcvcountry &lt;chr&gt; "Oceanus", NA, "Oceanus", NA, "Oceanus", "Utoporiana", NA, …</code></pre>
</div>
</div>
<p>Use <code>as.factor</code> to convert the character data type to factor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>MC2_nodes<span class="sc">$</span>id <span class="ot">&lt;-</span><span class="fu">as.factor</span>(MC2_nodes<span class="sc">$</span>id)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>MC2_nodes<span class="sc">$</span>shpcountry<span class="ot">&lt;-</span><span class="fu">as.factor</span>(MC2_nodes<span class="sc">$</span>shpcountry)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>MC2_nodes<span class="sc">$</span>rcvcountry<span class="ot">&lt;-</span><span class="fu">as.factor</span>(MC2_nodes<span class="sc">$</span>rcvcountry)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(MC2_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       id             shpcountry           rcvcountry   
 -1     :    1   Marebak   : 3657   Oceanus     :29312  
 -10    :    1   Alverossia:  600   Coralmarica :  552  
 -100   :    1   Isliandor :  437   Sol y Oceana:  277  
 -1000  :    1   Merigrad  :  435   Marebak     :  151  
 -10000 :    1   Oceanus   :  418   Riodelsol   :   99  
 -10001 :    1   (Other)   : 6670   (Other)     : 1276  
 (Other):34570   NA's      :22359   NA's        : 2909  </code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We observed many NA in the shpcountry and rcvcountry columns. Since we are unable to infer the values for these columns, we need to remove rows with NA values.</p>
</div>
</div>
<p>We use <code>group_by</code> to check for each company id how many different <em>shipcountry</em> and <em>rcvcounty</em> are available to identify the overall trend. Each company only ship to 1 receiving country and ship from 1 shipping country.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>count<span class="ot">&lt;-</span>MC2_nodes <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">no_shpcountry=</span><span class="fu">n_distinct</span>(shpcountry),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">no_rcvcountry=</span><span class="fu">n_distinct</span>(rcvcountry)) </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       id        no_shpcountry no_rcvcountry
 -1     :    1   Min.   :1     Min.   :1    
 -10    :    1   1st Qu.:1     1st Qu.:1    
 -100   :    1   Median :1     Median :1    
 -1000  :    1   Mean   :1     Mean   :1    
 -10000 :    1   3rd Qu.:1     3rd Qu.:1    
 -10001 :    1   Max.   :1     Max.   :1    
 (Other):34570                              </code></pre>
</div>
</div>
</section>
<section id="extract-edge-information-for-the-main-graph" class="level2">
<h2 class="anchored" data-anchor-id="extract-edge-information-for-the-main-graph">Extract edge information for the main graph</h2>
<p>We only considered edges information of nodes in MC2_nodes and used <code>filter</code> to filter out the edges for those nodes. We ignored the <em>dataset</em> and <em>type</em> column and used <code>select</code> to select the rest of the attributes of edges of the main graph. Used <code>glimpse</code> to view the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>MC2_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, target, arrivaldate,hscode,weightkg,volumeteu,valueofgoodsusd,valueofgoods_omu) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(MC2_edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,309,087
Columns: 8
$ source           &lt;chr&gt; "AquaDelight Inc and Son's", "AquaDelight Inc and Son…
$ target           &lt;chr&gt; "BaringoAmerica Marine Ges.m.b.H.", "BaringoAmerica M…
$ arrivaldate      &lt;chr&gt; "2034-02-12", "2034-03-13", "2028-02-07", "2028-02-23…
$ hscode           &lt;chr&gt; "630630", "630630", "470710", "470710", "470710", "47…
$ weightkg         &lt;int&gt; 4780, 6125, 10855, 11250, 11165, 11290, 9000, 19490, …
$ volumeteu        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ valueofgoodsusd  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 87110, 188140, NA, 221110, 58…
$ valueofgoods_omu &lt;dbl&gt; 141015, 141015, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wrong data types for <em>arrivaldate</em> as well as other character type data need to be converted.</p>
</div>
</div>
<p>We used <code>as.factor</code> to convert <em>source, target, hscode</em>. <code>mutate</code> and <code>ymd</code> were used to convert <em>arrival date</em> data type to date and extract day of the week information from the date with <code>wday</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>MC2_edges<span class="ot">&lt;-</span>MC2_edges <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">arrivaldate =</span> <span class="fu">ymd</span>(arrivaldate)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weekday =</span> <span class="fu">wday</span>(arrivaldate,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">abbr =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">monthyear=</span><span class="fu">as.yearmon</span>(arrivaldate)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year=</span><span class="fu">year</span>(arrivaldate))<span class="sc">%&gt;%</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>MC2_edges<span class="sc">$</span>source<span class="ot">&lt;-</span><span class="fu">as.factor</span>(MC2_edges<span class="sc">$</span>source)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>MC2_edges<span class="sc">$</span>target<span class="ot">&lt;-</span><span class="fu">as.factor</span>(MC2_edges<span class="sc">$</span>target)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(MC2_edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,158,933
Columns: 11
$ source           &lt;fct&gt; AquaDelight Inc and Son's, AquaDelight Inc and Son's,…
$ target           &lt;fct&gt; BaringoAmerica Marine Ges.m.b.H., BaringoAmerica Mari…
$ arrivaldate      &lt;date&gt; 2034-02-12, 2034-03-13, 2028-02-07, 2028-02-23, 2028…
$ hscode           &lt;chr&gt; "630630", "630630", "470710", "470710", "470710", "47…
$ weightkg         &lt;int&gt; 4780, 6125, 10855, 11250, 11165, 11290, 9000, 19490, …
$ volumeteu        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ valueofgoodsusd  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 87110, 188140, NA, 221110, 58…
$ valueofgoods_omu &lt;dbl&gt; 141015, 141015, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ weekday          &lt;ord&gt; Sunday, Monday, Monday, Wednesday, Monday, Monday, We…
$ monthyear        &lt;yearmon&gt; Feb 2034, Mar 2034, Feb 2028, Feb 2028, Sep 2028,…
$ year             &lt;dbl&gt; 2034, 2034, 2028, 2028, 2028, 2028, 2028, 2028, 2028,…</code></pre>
</div>
</div>
<p><code>summary</code> was used to get a sense of data distribution. Since <em>volumeteu, valuesofgoods_usd</em> and <em>valueofgoods_omu</em> mostly contain 0 or NA values, we can disregard these columns in the analysis. We also observed that Friday seems to have the highest number of shipments while Wednesday has the lowest number of shipments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(MC2_edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                        source       
 Fresh Limited Liability Company           : 152521  
 Uttar Pradesh s CJSC                      : 116151  
 bǐ mù yú Sagl Distribution                :  89207  
 Coastal Cruisers Pic Shipping             :  82010  
 Chhattisgarh   Marine ecology A/S Delivery:  81212  
 Mar y Luna Sagl                           :  76853  
 (Other)                                   :4560979  
                              target         arrivaldate        
 hǎi dǎn Corporation Wharf       : 448746   Min.   :2028-01-01  
 Caracola del Sol Services       : 190708   1st Qu.:2029-09-16  
 Costa de la Felicidad Shipping  : 160527   Median :2031-05-06  
 Panope Limited Liability Company: 158081   Mean   :2031-06-03  
 Saltwater Supreme ОАО Forwading : 157800   3rd Qu.:2033-02-26  
 Mar del Este CJSC               : 126180   Max.   :2034-12-30  
 (Other)                         :3916891                       
    hscode             weightkg           volumeteu      valueofgoodsusd    
 Length:5158933     Min.   :        0   Min.   :   0.0   Min.   :0.000e+00  
 Class :character   1st Qu.:     3475   1st Qu.:   0.0   1st Qu.:2.843e+04  
 Mode  :character   Median :    11070   Median :   0.0   Median :7.385e+04  
                    Mean   :    38794   Mean   :   1.5   Mean   :8.716e+05  
                    3rd Qu.:    19960   3rd Qu.:   0.0   3rd Qu.:1.601e+05  
                    Max.   :495492485   Max.   :1215.0   Max.   :2.258e+11  
                                        NA's   :412222   NA's   :2779774    
 valueofgoods_omu        weekday         monthyear         year     
 Min.   :    1100   Sunday   :788160   Min.   :2028   Min.   :2028  
 1st Qu.:  148130   Monday   :745243   1st Qu.:2030   1st Qu.:2029  
 Median :  504485   Tuesday  :675274   Median :2031   Median :2031  
 Mean   : 1665142   Wednesday:601902   Mean   :2031   Mean   :2031  
 3rd Qu.: 1202560   Thursday :691915   3rd Qu.:2033   3rd Qu.:2033  
 Max.   :44744530   Friday   :866322   Max.   :2035   Max.   :2034  
 NA's   :5158652    Saturday :790117                                </code></pre>
</div>
</div>
</section>
<section id="filter-out-irrelevant-hscode" class="level2">
<h2 class="anchored" data-anchor-id="filter-out-irrelevant-hscode">Filter out irrelevant hscode</h2>
<p>We use <code>n_distinct()</code> to check the number of hscode available in the dataset. There are many hscode values that are not relevant to our project. For example, hscode 470710 is for shipment of paper or paperboard. hscode that are relevant to our fish data will include only those that starts with:</p>
<ul>
<li><p>“301”: Live Fish</p></li>
<li><p>“302: Fresh or chilled fish exclude fish fillets and fish meat in 304</p></li>
<li><p>“303”: Frozen fish</p></li>
<li><p>“304”: Fish fillets and fish meat (fresh, chilled or frozen)</p></li>
<li><p>“305”: Fish, dried, salted or in brine</p></li>
<li><p>“1604”: Extracts and juices of meat, fish or crustaceans molluscs or other aquatic invertebrates</p></li>
<li><p>“1605”: Prepared or preserved fish</p></li>
</ul>
<p>we use <code>substr()</code> to extract the first 3 digits from hscode and then filter rows with only the hscode that starts with 301, 302, 303, 304, 305. We also extract the first 4 digits from hscode and filter those with 1604 and 1605.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">n_distinct</span>(MC2_edges<span class="sc">$</span>hscode)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4748</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>MC2_edges_filtered<span class="ot">&lt;-</span>MC2_edges <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sub_hscode3=</span><span class="fu">substr</span>(hscode,<span class="dv">1</span>,<span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sub_hscode4=</span><span class="fu">substr</span>(hscode,<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sub_hscode3 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"301"</span>,<span class="st">"302"</span>,<span class="st">"303"</span>,<span class="st">"304"</span>,<span class="st">"305"</span>)<span class="sc">|</span>sub_hscode4 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1604"</span>,<span class="st">"1605"</span>)) </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>MC2_edges_filtered<span class="sc">$</span>hscode<span class="ot">&lt;-</span><span class="fu">as.factor</span>(MC2_edges_filtered<span class="sc">$</span>hscode)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(MC2_edges_filtered<span class="sc">$</span>hscode)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 304620  160414  304610  160521  304710  304750  304810  160510  160529  304870 
  87327   81628   36540   30238   27165   23911   21418   20530   14274   11508 
 303890  304720  304890  304990  160540  160420  303230  304740  303660  160413 
  10984    9714    9597    9444    9199    8977    8612    8505    7370    7148 
 303120  303130  160553  304790  304830  160419  304820  305320  160411  303630 
   6972    6690    4758    4530    3720    3007    2675    2192    2111    1960 
 303110  160556  305420  303310  304940  160415  303540  305410  160416  160551 
   1883    1871    1785    1634    1588    1446    1385    1248    1246    1225 
 160554  303290  303640  304390  305510  303420  303510  303140  160417  303530 
   1175    1072    1049     751     751     730     721     700     690     615 
 305630  305590  303690  303390  303330  304840  303670  303910  160559  304910 
    612     592     588     410     396     384     383     363     357     355 
 303590  303240  303830  304850  160552  304950  160555  160412  160558  305200 
    324     317     316     280     260     236     218     201     176     150 
 160432  303810  304690  303410  303430  304420  305490  301190  304490  303550 
    145     140     137     128     127     117     112     111     107     105 
 303570  160530  305100  305530  303250  305620  305690  302460  303820  305540 
    100      88      86      79      78      78      78      74      68      63 
 301110  303840  160557  303190  304410  304460  304320  305790  305390 (Other) 
     62      62      59      58      54      50      48      48      43     807 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated<span class="ot">&lt;-</span>MC2_edges_filtered <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hscode<span class="sc">==</span><span class="st">'304810'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, year) <span class="sc">%&gt;%</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weight=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weight<span class="sc">&gt;</span><span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="prepare-nodes-data" class="level2">
<h2 class="anchored" data-anchor-id="prepare-nodes-data">Prepare nodes data</h2>
<p>We prepare the nodes that are in the aggregated data source and target.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> MC2_edges_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> MC2_edges_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>MC2_nodes_aggregated <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>MC2_nodes_aggregated<span class="ot">&lt;-</span><span class="fu">merge</span>(MC2_nodes_aggregated, MC2_nodes, <span class="at">by=</span><span class="st">"id"</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>MC2_nodes_aggregated</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                        id     shpcountry
1                                                    -1155           &lt;NA&gt;
2                                                     -131           &lt;NA&gt;
3                                                     -206           &lt;NA&gt;
4                                                    -3305           &lt;NA&gt;
5                                                    -3346           &lt;NA&gt;
6                                                    -3413           &lt;NA&gt;
7                                                     -534           &lt;NA&gt;
8                                                     -811           &lt;NA&gt;
9                           3 Oceanography ОАО Marine life       Faraluna
10                             3 Trawler Corp Distribution     Brindisola
11                      Adriatic Tuna Shipyard GmbH United   Thessalandia
12                              Adriatic Tuna ОАО Carriers        Marebak
13                  Andhra Pradesh   Sextant Oyj Forwading      Zawalinda
14                       Anthony Limited Liability Company        Mawazam
15                                Aqua Aura LLC Investment        Marebak
16                           AquaCuisine AG Marine ecology        Marebak
17                  Arena Azul Ltd. Liability Co Solutions        Marebak
18                              Arena del Sol Incorporated        Marebak
19                               Arunachal Pradesh s Brine       Nalakond
20                        Arunachal Pradesh s Oceanography       Nalakond
21                                       Bahía del Este AB       Galduzim
22                                Belgian Cod BV Solutions    Coralmarica
23                              Blue Horizon Inc Transport        Marebak
24                                Blue Nile  LLC and Son's        Marebak
25                             Blue Ridge   OJSC Forwading      Zawalinda
26                                       Brisa del Este BV           &lt;NA&gt;
27                                Brisa Marina CJSC Bonito      Zawalinda
28                                           Bu yu wang AG      Zawalinda
29                                     Caracola Azul Oyj &amp;    Playa Solis
30                     Casablanca Coast  Flounder Oyj Line        Marebak
31                Chhattisgarh   Estuary Sp Marine biology   Thessalandia
32                          Chuan gou  Co Marine sanctuary        Marebak
33            Coastal Castaway Coast Corporation Worldwide     Alverossia
34                         Congo Rapids   Ltd. Corporation    Brindivaria
35                                  Coral Cove BV Delivery       Quornova
36                             Costa de Coral Kga Delivery      Riodelsol
37      Costa de Coral Limited Liability Company Transport        Marebak
38                          Costa de la Felicidad Shipping     Alverossia
39                                         Costa de Oro BV      Zawalinda
40                                       Costa del Sol A/S      Isliandor
41                                     Costa del Viento NV        Marebak
42               David Limited Liability Company Worldwide        Marebak
43                       Diao yu bi sai  Roe LLC Logistics        Marebak
44                  Dnipro  Breakwater LC Marine sanctuary      Zawalinda
45                  Drakensberg  Limited Liability Company      Jiraputra
46                                Estrella de la Costa SRL        Mawazam
47                                      Estrella de Mar AB      Zawalinda
48                           Estrella del Mar ОАО Shipping        Marebak
49                            Faroe Islands  Company World      Zawalinda
50                                  Fin Addiction Ltd Line        Marebak
51                    Fisherman's Best Marine conservation        Marebak
52                   Great Ruaha River  Rybachit Sagl Line        Marebak
53                               hǎi dǎn Corporation Wharf        Marebak
54                                     hǎi mǎ AS Sea spray        Marebak
55                                   Haryana s Plc Transit        Marebak
56                                       Hook S.A. de C.V.   Thessalandia
57                     Isla del Tesoro GmbH &amp; Co. KG Chart    Coralmarica
58                              jīn qiāng yú SRL Worldwide      Zawalinda
59                                   Kga Ltd. Liability Co      Zawalinda
60                          Kong zhong diao yu  Ges.m.b.H.        Oceanus
61                             Lake Manyara   ОАО Holdings        Marebak
62                                    Lake Nasser  Tom yum        Marebak
63                       Lake Victoria Nile    Corporation   Sol y Oceana
64                               Lake Victoria Nile    Inc      Isliandor
65                                        lú yú A/S Marine    Playa Solis
66                           Madagascar Coast  AG Freight         Oceanus
67                    Malawi Rift   GmbH &amp; Co. KG Tidepool     Utoporiana
68             Manipur  Market Ltd. Liability Co Transport        Marebak
69                           Mar de Cielo Ltd. Corporation       Rio Isla
70                                       Mar del Este CJSC       Merigrad
71                                    Mar del Norte United      Zawalinda
72                             Mar del Oeste S.p.A. United        Marebak
73                                 Nagaland Sea Catch GmbH        Marebak
74          Nagaland Sea Catch Ltd. Liability Co Logistics        Marebak
75             Nautical Navigators Ges.m.b.H. Distribution     Alverossia
76                                        OceanKing s SE _      Zawalinda
77                                     Ola Azul SRL United        Marebak
78                                        Olas del Sur Ltd       Faraluna
79                                         Pao gan SE Seal     Alverossia
80            Playa de Arena Submarine S.A. de C.V. Marine     Vesperanda
81                                         Playa de Oro BV        Marebak
82                                     Playa del Cielo ОАО        Marebak
83                           Portuguese Sea Bass AS Marine        Marebak
84                             Punjab  Market LC Worldwide   Thessalandia
85        Punjab Sea  Ltd. Corporation Marine conservation        Marebak
86                       ReefR estaurant Oyj International       Coralada
87                 ReefRider Foods Ltd. Corporation Family        Oceanus
88                                 Rift Valley fishery Inc Puerto del Mar
89                                 Sahara  LLC BV Shipping   Thessalandia
90                        Sailors and Surfers Kga Overseas        Galdara
91                                  SaltSea Corp and Son's        Marebak
92                   Saltwater Sirens S.p.A. International        Marebak
93               Saltwater Supreme Pelican Ltd Enterprises     Puerto Sol
94                           Sander Ltd. Corporation Leska      Zawalinda
95              Scottish Lobster Cruise ship SRL Transport        Marebak
96                       Scottish Oysters Consulting Leska      Zawalinda
97                                      Sea Spray AS Cargo      Zawalinda
98                                   Sea Star LLC Shipping       Zimawand
99                          SeaBass  Lighthouse AG Express   Thessalandia
100                        SeaBass Company Express Estuary      Zawalinda
101                      Selous Game Reserve  S.A. de C.V.      Isliandor
102                      Selous Game Reserve  SE Solutions        Marebak
103                                 Senegal Coast  AG Line        Marebak
104                                     Shona S.A. de C.V.      Zawalinda
105                                 Shou gan  Sagl Mudflat        Oceanus
106                        Sparrmans  Inc Marine sanctuary        Marebak
107                                    Surf and Sea Marina      Zawalinda
108                              Tide Turners A/S Delivery        Marebak
109                      Transit Limited Liability Company    Coralmarica
110                           Turkish Calamari A/S &amp; Son's        Marebak
111                                    Uttar Pradesh s Oyj        Marebak
112                              Uttar Pradesh s Transport       Galduzim
113                     Uttar Pradesh Sea  Company Seafoam     Utoporiana
114 Uttarakhand  Market Limited Liability Company Nautical        Helixia
115                            Volga River LLC Enterprises       Quornova
116    Wave Watchers Underwater Ltd. Corporation Solutions        Marebak
117                    Yenisei  Eel GmbH &amp; Co. KG Services       Merigrad
118                                Yu xian  SRL Industrial     Sirenareef
119                Zambezi Escarpment  Incorporated United     Kondanovia
120                           Zambezi Rapids  Plc Holdings        Marebak
      rcvcountry
1        Oceanus
2        Oceanus
3        Oceanus
4        Oceanus
5        Oceanus
6        Oceanus
7        Oceanus
8        Oceanus
9        Oceanus
10       Oceanus
11       Oceanus
12       Oceanus
13  Sol y Oceana
14       Oceanus
15          &lt;NA&gt;
16       Marebak
17          &lt;NA&gt;
18       Marebak
19       Oceanus
20       Oceanus
21          &lt;NA&gt;
22   Coralmarica
23       Marebak
24          &lt;NA&gt;
25       Oceanus
26       Oceanus
27  Sol y Oceana
28       Oceanus
29       Oceanus
30       Oceanus
31       Oceanus
32       Marebak
33       Oceanus
34       Oceanus
35       Oceanus
36       Oceanus
37       Oceanus
38       Oceanus
39       Oceanus
40       Oceanus
41       Marebak
42     Kuzalanda
43       Oceanus
44     Zawalinda
45       Oceanus
46       Oceanus
47          &lt;NA&gt;
48          &lt;NA&gt;
49   Coralmarica
50          &lt;NA&gt;
51       Oceanus
52       Oceanus
53       Oceanus
54       Marebak
55          &lt;NA&gt;
56  Thessalandia
57       Oceanus
58          &lt;NA&gt;
59          &lt;NA&gt;
60       Oceanus
61       Oceanus
62          &lt;NA&gt;
63       Oceanus
64       Oceanus
65       Oceanus
66       Oceanus
67    Utoporiana
68       Marebak
69       Oceanus
70       Oceanus
71       Oceanus
72       Oceanus
73          &lt;NA&gt;
74          &lt;NA&gt;
75          &lt;NA&gt;
76       Oceanus
77          &lt;NA&gt;
78       Oceanus
79       Oceanus
80       Oceanus
81       Oceanus
82       Marebak
83          &lt;NA&gt;
84       Oceanus
85       Marebak
86      Coralada
87       Oceanus
88       Oceanus
89       Oceanus
90       Oceanus
91       Marebak
92          &lt;NA&gt;
93       Oceanus
94     Riodelsol
95       Marebak
96  Sol y Oceana
97       Oceanus
98  Sol y Oceana
99  Thessalandia
100 Sol y Oceana
101      Oceanus
102         &lt;NA&gt;
103      Oceanus
104     Valtalmo
105      Oceanus
106         &lt;NA&gt;
107      Oceanus
108         &lt;NA&gt;
109      Oceanus
110      Marebak
111      Oceanus
112      Oceanus
113      Oceanus
114      Oceanus
115      Oceanus
116      Marebak
117      Oceanus
118      Oceanus
119      Oceanus
120      Marebak</code></pre>
</div>
</div>
</section>
</section>
<section id="data-visualization" class="level1">
<h1>Data Visualization</h1>
<section id="visualize-the-main-graph" class="level2">
<h2 class="anchored" data-anchor-id="visualize-the-main-graph">Visualize the main graph</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>MC2_graph<span class="ot">&lt;-</span><span class="fu">tbl_graph</span>(<span class="at">nodes=</span>MC2_nodes_aggregated,                          <span class="at">edges=</span>MC2_edges_aggregated,                          <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>MC2_graph </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 120 nodes and 217 edges
#
# A directed acyclic multigraph with 13 components
#
# A tibble: 120 × 3
  id    shpcountry rcvcountry
  &lt;fct&gt; &lt;fct&gt;      &lt;fct&gt;     
1 -1155 &lt;NA&gt;       Oceanus   
2 -131  &lt;NA&gt;       Oceanus   
3 -206  &lt;NA&gt;       Oceanus   
4 -3305 &lt;NA&gt;       Oceanus   
5 -3346 &lt;NA&gt;       Oceanus   
6 -3413 &lt;NA&gt;       Oceanus   
# ℹ 114 more rows
#
# A tibble: 217 × 5
   from    to hscode  year weight
  &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;dbl&gt;  &lt;int&gt;
1     1     2 304810  2030     22
2     1     2 304810  2032     22
3     3     4 304810  2029     37
# ℹ 214 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># |fig-width: 100 </span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># |fig-height: 100 </span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set_graph_style</span>()</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>MC2_graph <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>)<span class="sc">+</span>   </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()<span class="sc">+</span>   </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>()<span class="sc">+</span>   </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>MC2_graph <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">centrality =</span> <span class="fu">centrality_authority</span>())<span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>() <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> centrality, <span class="at">colour =</span> centrality))<span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">guide =</span> <span class="st">'legend'</span>) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>edges_df<span class="ot">&lt;-</span>MC2_graph <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>nodes_df<span class="ot">&lt;-</span>MC2_graph <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label=</span>id) <span class="sc">%&gt;%</span> </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_df,edges_df)<span class="sc">%&gt;%</span>    </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>, </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">smooth =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>,              </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">"curvedCW"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span>    </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed=</span><span class="dv">123</span>) <span class="sc">%&gt;%</span>    </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-82a0cef6e6e3fd4c945d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-82a0cef6e6e3fd4c945d">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120],"label":["-1155","-131","-206","-3305","-3346","-3413","-534","-811","3 Oceanography ОАО Marine life","3 Trawler Corp Distribution","Adriatic Tuna Shipyard GmbH United","Adriatic Tuna ОАО Carriers","Andhra Pradesh   Sextant Oyj Forwading","Anthony Limited Liability Company","Aqua Aura LLC Investment","AquaCuisine AG Marine ecology","Arena Azul Ltd. Liability Co Solutions","Arena del Sol Incorporated","Arunachal Pradesh s Brine","Arunachal Pradesh s Oceanography","Bahía del Este AB","Belgian Cod BV Solutions","Blue Horizon Inc Transport","Blue Nile  LLC and Son's","Blue Ridge   OJSC Forwading","Brisa del Este BV","Brisa Marina CJSC Bonito","Bu yu wang AG","Caracola Azul Oyj &","Casablanca Coast  Flounder Oyj Line","Chhattisgarh   Estuary Sp Marine biology","Chuan gou  Co Marine sanctuary","Coastal Castaway Coast Corporation Worldwide","Congo Rapids   Ltd. Corporation","Coral Cove BV Delivery","Costa de Coral Kga Delivery","Costa de Coral Limited Liability Company Transport","Costa de la Felicidad Shipping","Costa de Oro BV","Costa del Sol A/S","Costa del Viento NV","David Limited Liability Company Worldwide","Diao yu bi sai  Roe LLC Logistics","Dnipro  Breakwater LC Marine sanctuary","Drakensberg  Limited Liability Company","Estrella de la Costa SRL","Estrella de Mar AB","Estrella del Mar ОАО Shipping","Faroe Islands  Company World","Fin Addiction Ltd Line","Fisherman's Best Marine conservation","Great Ruaha River  Rybachit Sagl Line","hǎi dǎn Corporation Wharf","hǎi mǎ AS Sea spray","Haryana s Plc Transit","Hook S.A. de C.V.","Isla del Tesoro GmbH & Co. KG Chart","jīn qiāng yú SRL Worldwide","Kga Ltd. Liability Co","Kong zhong diao yu  Ges.m.b.H.","Lake Manyara   ОАО Holdings","Lake Nasser  Tom yum","Lake Victoria Nile    Corporation","Lake Victoria Nile    Inc","lú yú A/S Marine","Madagascar Coast  AG Freight ","Malawi Rift   GmbH & Co. KG Tidepool","Manipur  Market Ltd. Liability Co Transport","Mar de Cielo Ltd. Corporation","Mar del Este CJSC","Mar del Norte United","Mar del Oeste S.p.A. United","Nagaland Sea Catch GmbH","Nagaland Sea Catch Ltd. Liability Co Logistics","Nautical Navigators Ges.m.b.H. Distribution","OceanKing s SE _","Ola Azul SRL United","Olas del Sur Ltd","Pao gan SE Seal","Playa de Arena Submarine S.A. de C.V. Marine","Playa de Oro BV","Playa del Cielo ОАО","Portuguese Sea Bass AS Marine","Punjab  Market LC Worldwide","Punjab Sea  Ltd. Corporation Marine conservation","ReefR estaurant Oyj International","ReefRider Foods Ltd. Corporation Family","Rift Valley fishery Inc","Sahara  LLC BV Shipping","Sailors and Surfers Kga Overseas","SaltSea Corp and Son's","Saltwater Sirens S.p.A. International","Saltwater Supreme Pelican Ltd Enterprises","Sander Ltd. Corporation Leska","Scottish Lobster Cruise ship SRL Transport","Scottish Oysters Consulting Leska","Sea Spray AS Cargo","Sea Star LLC Shipping","SeaBass  Lighthouse AG Express","SeaBass Company Express Estuary","Selous Game Reserve  S.A. de C.V.","Selous Game Reserve  SE Solutions","Senegal Coast  AG Line","Shona S.A. de C.V.","Shou gan  Sagl Mudflat","Sparrmans  Inc Marine sanctuary","Surf and Sea Marina","Tide Turners A/S Delivery","Transit Limited Liability Company","Turkish Calamari A/S & Son's","Uttar Pradesh s Oyj","Uttar Pradesh s Transport","Uttar Pradesh Sea  Company Seafoam","Uttarakhand  Market Limited Liability Company Nautical","Volga River LLC Enterprises","Wave Watchers Underwater Ltd. Corporation Solutions","Yenisei  Eel GmbH & Co. KG Services","Yu xian  SRL Industrial","Zambezi Escarpment  Incorporated United","Zambezi Rapids  Plc Holdings"],"x":[0.510281268168556,0.405581642514361,-0.546960597056593,-0.524678500080844,0.111733623894619,0.0571125698244332,0.60193305947179,0.683612281856951,-0.758304246690452,-0.801720643672,-0.574270460569322,-0.712890393157712,-0.649648929098798,0.774172550276774,0.730557256748007,-0.745039667400781,-0.453022096223476,0.53486507291233,0.464109769547627,0.752281090943717,0.698651941923774,0.698746078750934,0.821568308779168,0.00457713802995485,0.147423070329072,-0.303959309329204,-0.25220930354956,-0.232459809765774,-0.375277645819805,0.19944468141727,-0.760790672581912,0.458271127650283,-0.733733118909244,0.116149810183706,0.175295151878323,-0.665635049461954,0.475999187307149,0.541702657676602,0.441213545237301,-0.388708774105844,-0.0392006193712362,0.0737051707315541,0.484404119289246,0.58819841837381,-0.272270783478846,-0.363189397851287,0.555976185495121,-0.878644803617309,0.0703121533455076,-0.00632923140148656,-0.204230771297309,-0.0760418131649722,-0.37261580113464,-0.751375923515085,-0.931217494804644,-0.0202588595597277,0.239880469178475,0.202191566243342,-0.528351306032339,-0.569794507265112,0.0212730274392001,-0.875697638225419,-0.396443335055755,0.380421189304208,1,0.999347312142833,-0.546531088759187,0.197190668356908,0.209083186105962,-0.0458462358494234,-0.481298755875838,0.359003223992177,0.365878946911333,0.284561821654181,-0.66732846719896,-0.60245059480776,-0.684694874932121,-0.752428519622959,-0.844715565793607,-0.830477257785414,-0.63008047617921,-0.441580191326458,-0.324910489805646,0.220252811003864,0.353859318858395,-0.837904551963386,-1,-0.951012560501642,0.996435756870081,0.497095466484368,-0.436627361418582,-0.299549036426268,0.438119582085131,-0.490217291178653,0.0511976573271853,0.935916548050983,0.883927643042876,0.199886030786544,0.254313358854538,-0.0209519934341225,0.64287873372834,0.75197261452796,0.455538528235348,0.115054384162404,-0.274652394195517,-0.194177592770786,-0.610934941623626,0.641827984958831,0.757978137155733,0.80004554100155,0.85418003177502,0.771575587810742,-0.536114505288955,-0.0935659334075046,-0.180613479448679,0.00439142216788624,0.0988713173773599,-0.286807633172149,0.23906497620159,-0.596294042145102],"y":[0.714498995402805,0.711204917900185,0.518546583434644,0.308232853669587,-0.767821806434304,-0.817324358257262,-0.767955897111165,-0.720430682499361,-0.615464706716711,-0.455081135707881,-0.136018080183017,-0.15817289242939,0.25673533074623,0.621690167275468,0.701892477696236,-0.219672990839787,0.537319885660173,0.239110481722347,0.131200818640447,-0.265019913925374,-0.179043257715693,-0.375594237706672,-0.298965287971585,0.6031752417085,0.452799346262467,-0.377226805414885,-0.164471836911203,-0.235646963121883,-0.543400931256248,0.408059996388202,-0.317277374547028,-0.0594564869503301,0.38210564788357,0.367151077919621,0.226971419178047,0.072464927032371,-0.521192597635399,-0.591565059466656,-0.445896926319517,-0.724128106562269,0.890036469470757,0.903061725348723,0.429268099257953,0.46454040434991,0.931589200149685,0.913851738148647,0.0748123229864837,-0.147829436515764,-0.0428533736899949,0.036210707494762,-0.0155138310109271,-0.202471244755889,0.489460420591815,0.27852730040406,-0.469401914087773,-0.0289894954871704,-0.49789942443168,-0.58325576843558,-0.407999823368627,-0.501421280778417,-0.330839235007618,-0.241807540211087,0.28910168349743,0.84591554158493,0.0071709385434926,-0.0810910793080842,0.406503856448475,0.8599759564253,0.955678741763959,0.113540647344724,-0.717925941053154,-0.76515697014057,-0.84218282037624,-0.913456458426166,0.537734853985329,0.727333029283936,0.669911643672816,0.607667704027755,0.546603339491908,-0.541691190496536,-0.233863063835469,0.394350376963433,0.380191903078603,0.548278951176631,0.605713300064441,-0.0649967233723512,-0.0487576770870856,0.0538760844884736,-0.170448690409952,0.826481582092245,0.205658489702392,-0.70897289520094,0.0511535114970423,-0.627801309264841,0.483795828090031,0.368352358158882,0.450618219088587,0.143608156393112,-0.00594491841259626,1,-0.0646701263965157,-0.0570725108987471,-0.892669826118766,0.591612835060514,-0.971198645552392,-0.97053430754211,0.3514635712627,0.168931915760291,0.260602823874627,0.152278873933618,-0.521085101494042,-0.569613189898441,0.205274572322414,-0.686303714498997,-0.63404034327582,-0.994262569054697,-1,-0.58400643427499,0.474758183836087,0.105293253025637]},"edges":{"from":[1,1,3,5,5,5,7,9,11,13,13,14,16,16,16,17,18,20,20,20,20,20,20,20,20,20,20,24,26,26,26,26,26,26,30,30,30,30,30,30,31,31,31,31,31,31,32,33,34,34,34,34,34,34,36,36,37,37,37,40,41,41,43,43,43,43,45,47,47,48,49,49,49,51,51,51,51,51,51,51,51,51,51,51,53,54,55,56,56,56,56,56,56,57,59,59,59,59,59,61,62,63,63,64,65,65,67,67,67,68,68,68,68,68,68,70,70,70,71,72,72,72,74,75,75,75,75,75,75,75,75,75,80,80,80,81,81,82,82,83,84,84,84,84,84,86,86,86,86,86,89,89,90,91,91,92,93,93,93,94,95,95,95,95,96,98,98,98,98,98,98,98,98,98,98,100,101,101,101,101,101,101,103,104,104,105,105,107,107,107,107,108,108,108,108,111,113,113,114,114,116,118,118,118,118,118,118,118,118,118,119,119,119,119,120,120,120],"to":[2,2,4,6,6,6,8,10,12,4,4,15,12,12,12,4,19,21,21,21,21,22,23,23,23,23,23,25,27,27,28,29,29,29,25,25,25,25,25,25,10,10,10,12,12,12,19,4,25,25,25,25,25,35,12,4,38,39,39,29,42,42,44,44,19,2,46,19,19,12,50,50,50,52,27,27,27,27,50,50,50,50,28,4,4,4,10,50,50,50,50,50,50,58,12,29,29,60,60,52,12,4,4,2,66,66,4,4,4,2,42,42,42,69,69,50,50,50,29,73,73,73,73,76,77,77,78,78,78,79,4,4,10,10,10,12,12,4,4,4,25,25,25,25,85,87,88,12,12,12,66,66,2,4,4,29,19,19,19,29,25,25,25,25,97,19,19,50,50,50,99,25,35,35,35,42,102,102,19,21,21,21,73,25,25,106,106,4,4,4,4,109,19,19,110,112,4,4,115,115,117,29,29,29,29,29,29,115,115,115,25,25,25,25,12,4,4],"hscode":["304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810"],"year":[2030,2032,2029,2032,2033,2034,2034,2032,2028,2029,2030,2030,2029,2030,2032,2032,2032,2029,2031,2032,2033,2033,2028,2029,2030,2031,2033,2033,2028,2029,2028,2031,2032,2033,2028,2029,2030,2031,2032,2034,2030,2032,2034,2028,2029,2030,2031,2029,2030,2031,2032,2033,2034,2033,2030,2028,2033,2033,2034,2034,2033,2034,2032,2033,2033,2031,2033,2032,2034,2028,2032,2033,2034,2033,2028,2031,2032,2033,2029,2030,2033,2034,2029,2028,2034,2029,2029,2029,2030,2031,2032,2033,2034,2032,2028,2028,2029,2030,2031,2034,2028,2029,2030,2034,2033,2034,2032,2033,2034,2033,2031,2032,2034,2029,2030,2032,2033,2034,2033,2031,2033,2034,2034,2033,2032,2033,2029,2030,2031,2032,2033,2034,2032,2033,2034,2033,2034,2033,2034,2029,2031,2032,2033,2034,2029,2029,2031,2029,2030,2031,2030,2032,2034,2031,2032,2033,2028,2029,2030,2034,2028,2029,2030,2031,2028,2033,2034,2030,2031,2032,2028,2030,2028,2029,2030,2034,2032,2033,2034,2032,2033,2034,2034,2031,2032,2029,2030,2031,2032,2033,2034,2028,2033,2034,2029,2034,2032,2033,2032,2033,2033,2028,2029,2030,2031,2032,2033,2031,2032,2033,2031,2032,2033,2034,2034,2032,2033],"weight":[22,22,37,21,29,43,21,23,39,35,32,23,21,28,29,40,28,23,48,54,29,27,49,57,133,47,48,28,25,34,29,23,30,42,25,36,25,24,33,28,27,21,21,22,44,25,24,42,52,123,133,157,156,24,36,29,23,51,45,22,24,21,32,24,23,30,23,36,22,51,32,33,38,24,59,28,42,22,75,55,23,30,38,24,22,35,53,23,32,40,55,61,70,24,26,59,75,74,50,21,57,74,62,22,28,31,42,48,93,21,41,21,23,26,65,22,46,39,26,23,30,33,28,22,40,30,23,61,80,40,28,148,75,80,37,25,53,86,138,25,34,187,220,223,25,22,35,22,24,22,28,21,36,81,29,26,58,58,24,24,28,63,61,31,24,80,97,32,98,68,29,37,77,87,22,23,22,36,26,51,30,27,34,41,34,28,40,47,56,104,130,21,21,53,25,22,56,72,26,22,31,180,179,160,68,48,66,79,62,33,21,92,83,79,78,53,36]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"arrows":"to","smooth":{"enabled":true,"type":"curvedCW"}},"physics":{"stabilization":false},"layout":{"randomSeed":123}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="temporal-analysis" class="level2">
<h2 class="anchored" data-anchor-id="temporal-analysis">Temporal analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>overall_trend <span class="ot">&lt;-</span>MC2_edges_filtered<span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(monthyear) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weight=</span><span class="fu">n</span>(),</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">weightkg=</span><span class="fu">mean</span>(weightkg)) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(monthyear) <span class="sc">%&gt;%</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>overall_trend <span class="sc">%&gt;%</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> monthyear, <span class="at">y=</span>weightkg))<span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>overall_trend <span class="ot">&lt;-</span>MC2_edges_filtered<span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(monthyear<span class="sc">&lt;</span><span class="st">'Jan 2034'</span> <span class="sc">&amp;</span> monthyear<span class="sc">&gt;=</span><span class="st">'Jan 2033'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">monthyear=</span><span class="fu">as.factor</span>(monthyear)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(weekday,monthyear) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weight=</span><span class="fu">n</span>(),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">weightkg=</span><span class="fu">mean</span>(weightkg)) <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(weekday,monthyear) <span class="sc">%&gt;%</span> </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>overall_trend <span class="sc">%&gt;%</span> </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(monthyear,weekday, <span class="at">fill=</span>weight))<span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_tile</span>(<span class="at">colour=</span><span class="st">'white'</span>,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">size=</span><span class="fl">0.1</span>)<span class="sc">+</span> </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_gradient</span>(<span class="at">name =</span> <span class="st">"No of shipments"</span>,</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">low =</span> <span class="st">"sky blue"</span>, </span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">high =</span> <span class="st">"dark blue"</span>) <span class="sc">+</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, </span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> <span class="cn">NULL</span>, </span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">title =</span> <span class="st">"No of shipments by month year and weekday"</span>) <span class="sc">+</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">30</span>, <span class="at">vjust=</span><span class="fl">0.5</span>),</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>overall_trend <span class="ot">&lt;-</span>MC2_edges_filtered<span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(monthyear<span class="sc">&gt;=</span><span class="st">'Jan 2034'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">monthyear=</span><span class="fu">as.factor</span>(monthyear)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(weekday,monthyear) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weight=</span><span class="fu">n</span>(),</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">weightkg=</span><span class="fu">mean</span>(weightkg)) <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(weekday,monthyear) <span class="sc">%&gt;%</span> </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>overall_trend <span class="sc">%&gt;%</span> </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(monthyear,weekday, <span class="at">fill=</span>weight))<span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_tile</span>(<span class="at">colour=</span><span class="st">'white'</span>,</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">size=</span><span class="fl">0.1</span>)<span class="sc">+</span> </span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_gradient</span>(<span class="at">name =</span> <span class="st">"No of shipments"</span>,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">low =</span> <span class="st">"sky blue"</span>, </span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">high =</span> <span class="st">"dark blue"</span>) <span class="sc">+</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> <span class="cn">NULL</span>, </span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">title =</span> <span class="st">"No of shipments by month year and weekday"</span>) <span class="sc">+</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">30</span>, <span class="at">vjust=</span><span class="fl">0.5</span>),</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>source_trend<span class="ot">&lt;-</span>MC2_edges_filtered<span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, monthyear) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weight=</span><span class="fu">n</span>(),</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">weightkg=</span><span class="fu">sum</span>(weightkg)) <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(monthyear) <span class="sc">%&gt;%</span> </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>source_trend</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 73,051 × 4
   source                                          monthyear weight weightkg
   &lt;fct&gt;                                           &lt;yearmon&gt;  &lt;int&gt;    &lt;int&gt;
 1 2 Limited Liability Company                     Jan 2028       2    38025
 2 4 S.A. de C.V. Shipping                         Jan 2028       2    37705
 3 5 Sashimi NV Holdings                           Jan 2028       3    65515
 4 8 Aquamarine Limited Liability Company Holdings Jan 2028       7   138640
 5 9 Charter Boat  Plc Overseas                    Jan 2028      14   359390
 6 9 Marine biology Ltd Family                     Jan 2028      30   465345
 7 Adair S.A. de C.V.                              Jan 2028       1    19995
 8 Adriatic Catch Ltd Transport                    Jan 2028       2    24005
 9 Adriatic Mackerel NV Shipping                   Jan 2028       2    54970
10 Adriatic Squid Mussel Sp Transit                Jan 2028       2    75140
# ℹ 73,041 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>source_trend<span class="ot">&lt;-</span>source_trend <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weightkg_pct_change=</span><span class="fu">round</span>((weightkg<span class="sc">/</span><span class="fu">lag</span>(weightkg)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight_pct_change=</span><span class="fu">round</span>((weight<span class="sc">/</span><span class="fu">lag</span>(weight)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count<span class="sc">==</span><span class="dv">84</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(source_trend)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                     source       monthyear        weight      
 Ancla del Mar Marine ecology           :  84   Min.   :2028   Min.   :  1.00  
 Aqua Aura SE Marine life               :  84   1st Qu.:2030   1st Qu.:  9.00  
 AquaCuisine  Ltd. Liability Co Nautilus:  84   Median :2031   Median : 16.00  
 Arena del Sol SRL                      :  84   Mean   :2031   Mean   : 35.06  
 Brisa del Este Brine                   :  84   3rd Qu.:2033   3rd Qu.: 30.00  
 Brisa Marina CJSC Bonito               :  84   Max.   :2035   Max.   :709.00  
 (Other)                                :3360                                  
    weightkg        weightkg_pct_change weight_pct_change     count   
 Min.   :     800   Min.   : -100.00    Min.   : -96.00   Min.   :84  
 1st Qu.:  165091   1st Qu.:  -29.00    1st Qu.: -29.00   1st Qu.:84  
 Median :  324048   Median :   -0.50    Median :   0.00   Median :84  
 Mean   : 1069172   Mean   :   32.52    Mean   :  24.12   Mean   :84  
 3rd Qu.:  673940   3rd Qu.:   42.00    3rd Qu.:  40.00   3rd Qu.:84  
 Max.   :24550125   Max.   :14599.00    Max.   :3100.00   Max.   :84  
                    NA's   :46          NA's   :46                    </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)  </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(source_trend, <span class="fu">aes</span>(<span class="at">x =</span> monthyear, <span class="at">y =</span> weight_pct_change,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour=</span>source))<span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>) </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(source_trend, <span class="fu">aes</span>(<span class="at">x =</span> monthyear, <span class="at">y =</span> weightkg_pct_change,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour=</span>source))<span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>target_trend<span class="ot">&lt;-</span>MC2_edges_filtered<span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(target,year) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weight=</span><span class="fu">n</span>(),</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">weightkg=</span><span class="fu">sum</span>(weightkg)) <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(year)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>target_trend</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11,889 × 4
# Groups:   target [5,306]
   target  year weight weightkg
   &lt;fct&gt;  &lt;dbl&gt;  &lt;int&gt;    &lt;int&gt;
 1 -100    2028      5    94520
 2 -10012  2028      1    22645
 3 -10013  2028      7   156325
 4 -10014  2028      6   143880
 5 -10015  2028      1    19620
 6 -10016  2028     10   126070
 7 -10017  2028      1    23100
 8 -10018  2028      1    22830
 9 -10019  2028      1    22020
10 -10020  2028      1    18530
# ℹ 11,879 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>target_trend<span class="ot">&lt;-</span>target_trend <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weightkg_pct_change=</span><span class="fu">round</span>((weightkg<span class="sc">/</span><span class="fu">lag</span>(weightkg)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight_pct_change=</span><span class="fu">round</span>((weight<span class="sc">/</span><span class="fu">lag</span>(weight)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count<span class="sc">==</span><span class="dv">7</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(target_trend)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     target          year          weight          weightkg        
 -100   :   7   Min.   :2028   Min.   :   1.0   Min.   :       80  
 -1320  :   7   1st Qu.:2029   1st Qu.:   7.0   1st Qu.:   134881  
 -159   :   7   Median :2031   Median :  22.0   Median :   467022  
 -2     :   7   Mean   :2031   Mean   : 162.6   Mean   :  4259007  
 -213   :   7   3rd Qu.:2033   3rd Qu.:  82.0   3rd Qu.:  1912420  
 -250   :   7   Max.   :2034   Max.   :7477.0   Max.   :194890245  
 (Other):2744                                                      
 weightkg_pct_change weight_pct_change      count  
 Min.   :  -100.0    Min.   :  -99.00   Min.   :7  
 1st Qu.:   -42.0    1st Qu.:  -39.00   1st Qu.:7  
 Median :     0.0    Median :    0.00   Median :7  
 Mean   :   258.9    Mean   :   73.93   Mean   :7  
 3rd Qu.:    70.0    3rd Qu.:   61.25   3rd Qu.:7  
 Max.   :126216.0    Max.   :16467.00   Max.   :7  
 NA's   :398         NA's   :398                   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(target_trend, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> weight_pct_change,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour=</span>target))<span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(target_trend, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> weightkg_pct_change,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour=</span>target))<span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
</section>
<section id="community-dectection" class="level2">
<h2 class="anchored" data-anchor-id="community-dectection">Community Dectection</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>graph<span class="ot">&lt;-</span><span class="fu">tbl_graph</span>(<span class="at">nodes=</span>MC2_nodes_aggregated,                          <span class="at">edges=</span>MC2_edges_aggregated,                          <span class="at">directed =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span>graph<span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">community =</span> <span class="fu">as.factor</span>(<span class="fu">group_optimal</span>(<span class="at">weights =</span> weight))) </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 120 nodes and 217 edges
#
# An undirected multigraph with 13 components
#
# A tibble: 120 × 4
  id    shpcountry rcvcountry community
  &lt;fct&gt; &lt;fct&gt;      &lt;fct&gt;      &lt;fct&gt;    
1 -1155 &lt;NA&gt;       Oceanus    4        
2 -131  &lt;NA&gt;       Oceanus    4        
3 -206  &lt;NA&gt;       Oceanus    2        
4 -3305 &lt;NA&gt;       Oceanus    2        
5 -3346 &lt;NA&gt;       Oceanus    11       
6 -3413 &lt;NA&gt;       Oceanus    11       
# ℹ 114 more rows
#
# A tibble: 217 × 5
   from    to hscode  year weight
  &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;dbl&gt;  &lt;int&gt;
1     1     2 304810  2030     22
2     1     2 304810  2032     22
3     3     4 304810  2029     37
# ℹ 214 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>edges<span class="ot">&lt;-</span>graph <span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.tibble</span>()</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>nodes<span class="ot">&lt;-</span>graph <span class="sc">%&gt;%</span> </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span> </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label=</span>id) <span class="sc">%&gt;%</span> </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">group=</span>community)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>           edges) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e46177cd32fa7b56e456" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-e46177cd32fa7b56e456">{"x":{"nodes":{"label":["-1155","-131","-206","-3305","-3346","-3413","-534","-811","3 Oceanography ОАО Marine life","3 Trawler Corp Distribution","Adriatic Tuna Shipyard GmbH United","Adriatic Tuna ОАО Carriers","Andhra Pradesh   Sextant Oyj Forwading","Anthony Limited Liability Company","Aqua Aura LLC Investment","AquaCuisine AG Marine ecology","Arena Azul Ltd. Liability Co Solutions","Arena del Sol Incorporated","Arunachal Pradesh s Brine","Arunachal Pradesh s Oceanography","Bahía del Este AB","Belgian Cod BV Solutions","Blue Horizon Inc Transport","Blue Nile  LLC and Son's","Blue Ridge   OJSC Forwading","Brisa del Este BV","Brisa Marina CJSC Bonito","Bu yu wang AG","Caracola Azul Oyj &","Casablanca Coast  Flounder Oyj Line","Chhattisgarh   Estuary Sp Marine biology","Chuan gou  Co Marine sanctuary","Coastal Castaway Coast Corporation Worldwide","Congo Rapids   Ltd. Corporation","Coral Cove BV Delivery","Costa de Coral Kga Delivery","Costa de Coral Limited Liability Company Transport","Costa de la Felicidad Shipping","Costa de Oro BV","Costa del Sol A/S","Costa del Viento NV","David Limited Liability Company Worldwide","Diao yu bi sai  Roe LLC Logistics","Dnipro  Breakwater LC Marine sanctuary","Drakensberg  Limited Liability Company","Estrella de la Costa SRL","Estrella de Mar AB","Estrella del Mar ОАО Shipping","Faroe Islands  Company World","Fin Addiction Ltd Line","Fisherman's Best Marine conservation","Great Ruaha River  Rybachit Sagl Line","hǎi dǎn Corporation Wharf","hǎi mǎ AS Sea spray","Haryana s Plc Transit","Hook S.A. de C.V.","Isla del Tesoro GmbH & Co. KG Chart","jīn qiāng yú SRL Worldwide","Kga Ltd. Liability Co","Kong zhong diao yu  Ges.m.b.H.","Lake Manyara   ОАО Holdings","Lake Nasser  Tom yum","Lake Victoria Nile    Corporation","Lake Victoria Nile    Inc","lú yú A/S Marine","Madagascar Coast  AG Freight ","Malawi Rift   GmbH & Co. KG Tidepool","Manipur  Market Ltd. Liability Co Transport","Mar de Cielo Ltd. Corporation","Mar del Este CJSC","Mar del Norte United","Mar del Oeste S.p.A. United","Nagaland Sea Catch GmbH","Nagaland Sea Catch Ltd. Liability Co Logistics","Nautical Navigators Ges.m.b.H. Distribution","OceanKing s SE _","Ola Azul SRL United","Olas del Sur Ltd","Pao gan SE Seal","Playa de Arena Submarine S.A. de C.V. Marine","Playa de Oro BV","Playa del Cielo ОАО","Portuguese Sea Bass AS Marine","Punjab  Market LC Worldwide","Punjab Sea  Ltd. Corporation Marine conservation","ReefR estaurant Oyj International","ReefRider Foods Ltd. Corporation Family","Rift Valley fishery Inc","Sahara  LLC BV Shipping","Sailors and Surfers Kga Overseas","SaltSea Corp and Son's","Saltwater Sirens S.p.A. International","Saltwater Supreme Pelican Ltd Enterprises","Sander Ltd. Corporation Leska","Scottish Lobster Cruise ship SRL Transport","Scottish Oysters Consulting Leska","Sea Spray AS Cargo","Sea Star LLC Shipping","SeaBass  Lighthouse AG Express","SeaBass Company Express Estuary","Selous Game Reserve  S.A. de C.V.","Selous Game Reserve  SE Solutions","Senegal Coast  AG Line","Shona S.A. de C.V.","Shou gan  Sagl Mudflat","Sparrmans  Inc Marine sanctuary","Surf and Sea Marina","Tide Turners A/S Delivery","Transit Limited Liability Company","Turkish Calamari A/S & Son's","Uttar Pradesh s Oyj","Uttar Pradesh s Transport","Uttar Pradesh Sea  Company Seafoam","Uttarakhand  Market Limited Liability Company Nautical","Volga River LLC Enterprises","Wave Watchers Underwater Ltd. Corporation Solutions","Yenisei  Eel GmbH & Co. KG Services","Yu xian  SRL Industrial","Zambezi Escarpment  Incorporated United","Zambezi Rapids  Plc Holdings"],"shpcountry":[null,null,null,null,null,null,null,null,"Faraluna","Brindisola","Thessalandia","Marebak","Zawalinda","Mawazam","Marebak","Marebak","Marebak","Marebak","Nalakond","Nalakond","Galduzim","Coralmarica","Marebak","Marebak","Zawalinda",null,"Zawalinda","Zawalinda","Playa Solis","Marebak","Thessalandia","Marebak","Alverossia","Brindivaria","Quornova","Riodelsol","Marebak","Alverossia","Zawalinda","Isliandor","Marebak","Marebak","Marebak","Zawalinda","Jiraputra","Mawazam","Zawalinda","Marebak","Zawalinda","Marebak","Marebak","Marebak","Marebak","Marebak","Marebak","Thessalandia","Coralmarica","Zawalinda","Zawalinda","Oceanus","Marebak","Marebak","Sol y Oceana","Isliandor","Playa Solis","Oceanus","Utoporiana","Marebak","Rio Isla","Merigrad","Zawalinda","Marebak","Marebak","Marebak","Alverossia","Zawalinda","Marebak","Faraluna","Alverossia","Vesperanda","Marebak","Marebak","Marebak","Thessalandia","Marebak","Coralada","Oceanus","Puerto del Mar","Thessalandia","Galdara","Marebak","Marebak","Puerto Sol","Zawalinda","Marebak","Zawalinda","Zawalinda","Zimawand","Thessalandia","Zawalinda","Isliandor","Marebak","Marebak","Zawalinda","Oceanus","Marebak","Zawalinda","Marebak","Coralmarica","Marebak","Marebak","Galduzim","Utoporiana","Helixia","Quornova","Marebak","Merigrad","Sirenareef","Kondanovia","Marebak"],"rcvcountry":["Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Sol y Oceana","Oceanus",null,"Marebak",null,"Marebak","Oceanus","Oceanus",null,"Coralmarica","Marebak",null,"Oceanus","Oceanus","Sol y Oceana","Oceanus","Oceanus","Oceanus","Oceanus","Marebak","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Marebak","Kuzalanda","Oceanus","Zawalinda","Oceanus","Oceanus",null,null,"Coralmarica",null,"Oceanus","Oceanus","Oceanus","Marebak",null,"Thessalandia","Oceanus",null,null,"Oceanus","Oceanus",null,"Oceanus","Oceanus","Oceanus","Oceanus","Utoporiana","Marebak","Oceanus","Oceanus","Oceanus","Oceanus",null,null,null,"Oceanus",null,"Oceanus","Oceanus","Oceanus","Oceanus","Marebak",null,"Oceanus","Marebak","Coralada","Oceanus","Oceanus","Oceanus","Oceanus","Marebak",null,"Oceanus","Riodelsol","Marebak","Sol y Oceana","Oceanus","Sol y Oceana","Thessalandia","Sol y Oceana","Oceanus",null,"Oceanus","Valtalmo","Oceanus",null,"Oceanus",null,"Oceanus","Marebak","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Marebak","Oceanus","Oceanus","Oceanus","Marebak"],"group":["4","4","2","2","11","11","12","12","3","3","3","3","2","13","13","3","2","1","1","7","7","7","7","6","6","5","1","1","5","6","3","1","2","6","1","3","9","9","9","5","4","4","4","4","14","14","1","3","1","1","1","1","2","2","3","1","15","15","5","5","1","3","2","4","10","10","2","4","4","1","5","8","8","8","2","2","2","2","2","3","3","2","2","6","6","3","3","3","10","4","2","5","1","5","6","16","16","1","1","4","7","7","8","6","17","17","2","1","1","1","18","18","2","5","5","19","19","5","6","3"],"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120],"x":[0.161166666782525,0.0861440336996524,-0.46953495350944,-0.452489798309434,0.580649074134489,0.517703538567686,0.658742658772907,0.737341030598375,0.538376658030126,0.403322589723469,0.172494725865374,0.073679662676096,-0.559885416767956,0.618217222562159,0.689505052260314,0.151259095761186,-0.563651477391658,-0.288350629801595,-0.162747813347008,-0.484231815440774,-0.412543715948212,-0.611202262313503,-0.486603626145689,0.113963849731833,-0.0648622675019261,0.3657363567015,0.168434668640002,0.253484191554188,0.517889437182629,-0.0119865785212382,0.25469732304002,-0.34984329523995,-0.636848104488089,-0.116308405390077,-0.160538662725606,-0.213096477136423,-0.994922438401987,-0.983820586762848,-1,0.69298574905224,0.454667008520425,0.389178165600111,-0.0731372067153531,-0.133403197433815,-0.498334703600188,-0.587310744872412,-0.142000644755504,0.224585638215939,0.0256664567585558,0.0154288988635176,0.0099703792921404,0.239614646519159,-0.683649724522344,-0.661141114037602,0.565724843599079,0.07656003225862,-0.820769063343556,-0.897647398502859,0.370833578747568,0.467386997974025,0.391289101164403,-0.0687211051386132,-0.592120668575194,-0.0322566413462562,-0.336516941664429,-0.262337450986515,-0.409611079382597,0.28380846634091,0.321269946474247,0.12028583347719,0.65565292506998,0.814920860260499,0.827594930948082,0.77455731964881,-0.613636652411588,-0.693633265312821,-0.597137997106809,-0.702792860893743,-0.796505920038223,0.42572812127815,0.0780924434674146,-0.475304930091123,-0.701874486112267,-0.0904463379639053,-0.120090188954253,0.0512149602864957,0.111579283464115,-0.0114439632332668,-0.192169696755865,0.0645220227841496,-0.38880280963924,0.614835444798716,-0.236040968532261,0.565248123038141,0.0280341554953956,-0.726986201813503,-0.804100012214826,-0.118440011126809,-0.265937494934914,0.501831351968188,-0.354228426129331,-0.470717388427724,0.912302726771865,-0.175992497972139,0.976487377884087,1,-0.521147544791336,0.000755110362333777,0.164296782354619,0.0993573576105187,0.924141635145544,0.83655309560446,-0.486069369699882,0.835549516161819,0.737580159787989,0.994266758614576,0.944853383141031,0.615417545414731,-0.0337429702905432,-0.259022691688092],"y":[0.929856069692925,0.8716092164286,0.0323813286374148,-0.200763472863724,0.434509724909354,0.461688273004181,0.205460893591287,0.164730500463686,-0.839281363971862,-0.768921699314931,-0.788799959144132,-0.614805804682899,-0.108073609431753,0.641096791291344,0.699292750822436,-0.635335552683645,0.0310312009478555,0.576921220945856,0.488198046647168,0.810921460416733,0.758079479876262,0.767731326841079,0.880046201052391,-0.28029782756262,-0.168544601376613,-0.187023482913121,-0.0717295965131929,-0.0636711227819035,-0.313345779623542,-0.126713444482326,-0.699121982765963,0.461365060645175,-0.0142753446002726,-0.074377129874637,0.111508792740231,-0.459044044695151,-0.0922091470881483,0.0402462871067535,-0.178428559780015,-0.285543018508683,0.911400587308314,0.848806273330309,0.73259005192856,0.827021051219219,-0.826829499030891,-0.808962315321717,0.593125526601883,-0.566367155822118,0.280178176148615,0.161213619402873,-0.00573907590776845,0.10528761260603,-0.0883596082799367,-0.279460228869399,-0.738052821884161,0.188983089659401,0.367516043953148,0.319713323114019,-0.468085624337838,-0.535441378812745,0.183709048375545,-0.716700283540059,-0.194892495984695,0.944853918489994,-0.912855331729678,-0.952269364075024,-0.285883072921951,0.837366802455229,0.747071312391875,0.244616197918288,-0.195041031569815,0.549217130831418,0.472497733153783,0.380123975911008,-0.405925299843887,-0.574960596947655,-0.533104381123598,-0.44722606445882,-0.466278450044649,-0.859011952842083,-0.70789517511609,-0.0759407383531069,-0.182719764023521,-0.315166102914262,-0.511994204168859,-0.77876391166524,-0.936888725248405,-0.91662955461635,-1,1,-0.103313517903481,-0.462130595163123,0.492443394145102,-0.168600166900397,-0.206001978712668,0.565627872316887,0.530787534409759,0.207639112399814,0.284817746606395,0.785269576333425,0.659652587721899,0.634540039535973,0.406050529518893,-0.206612028681358,-0.24276279865996,-0.167052383535024,-0.246217059016573,0.549283105207779,0.551494708493305,0.649855098275248,-0.0246948221197547,-0.00472852563433213,-0.343760860581505,-0.464152937841521,-0.41422119087857,0.133868691902369,0.209877533764391,-0.356537417018369,-0.266802363107942,-0.393401865365775]},"edges":{"from":[1,1,3,5,5,5,7,9,11,4,4,14,12,12,12,4,18,20,20,20,20,20,20,20,20,20,20,24,26,26,26,26,26,26,25,25,25,25,25,25,10,10,10,12,12,12,19,4,25,25,25,25,25,34,12,4,37,37,37,29,41,41,43,43,19,2,45,19,19,12,49,49,49,51,27,27,27,27,50,50,50,50,28,4,4,4,10,50,50,50,50,50,50,57,12,29,29,59,59,52,12,4,4,2,65,65,4,4,4,2,42,42,42,68,68,50,50,50,29,72,72,72,73,75,75,75,75,75,75,75,4,4,10,10,10,12,12,4,4,4,25,25,25,25,84,86,86,12,12,12,66,66,2,4,4,29,19,19,19,29,25,25,25,25,96,19,19,50,50,50,98,25,35,35,35,42,101,101,19,21,21,21,73,25,25,105,105,4,4,4,4,108,19,19,108,111,4,4,114,114,116,29,29,29,29,29,29,115,115,115,25,25,25,25,12,4,4],"to":[2,2,4,6,6,6,8,10,12,13,13,15,16,16,16,17,19,21,21,21,21,22,23,23,23,23,23,25,27,27,28,29,29,29,30,30,30,30,30,30,31,31,31,31,31,31,32,33,34,34,34,34,34,35,36,36,38,39,39,40,42,42,44,44,43,43,46,47,47,48,50,50,50,52,51,51,51,51,51,51,51,51,51,51,53,54,55,56,56,56,56,56,56,58,59,59,59,60,60,61,62,63,63,64,66,66,67,67,67,68,68,68,68,69,69,70,70,70,71,73,73,73,74,76,77,77,78,78,78,79,75,75,80,80,80,81,81,82,82,83,84,84,84,84,85,87,88,86,86,86,89,89,90,91,91,92,93,93,93,94,95,95,95,95,97,98,98,98,98,98,99,98,98,98,98,100,102,102,101,101,101,101,103,104,104,106,106,107,107,107,107,109,108,108,110,112,113,113,115,115,117,118,118,118,118,118,118,118,118,118,119,119,119,119,120,120,120],"hscode":["304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810","304810"],"year":[2030,2032,2029,2032,2033,2034,2034,2032,2028,2029,2030,2030,2029,2030,2032,2032,2032,2029,2031,2032,2033,2033,2028,2029,2030,2031,2033,2033,2028,2029,2028,2031,2032,2033,2028,2029,2030,2031,2032,2034,2030,2032,2034,2028,2029,2030,2031,2029,2030,2031,2032,2033,2034,2033,2030,2028,2033,2033,2034,2034,2033,2034,2032,2033,2033,2031,2033,2032,2034,2028,2032,2033,2034,2033,2028,2031,2032,2033,2029,2030,2033,2034,2029,2028,2034,2029,2029,2029,2030,2031,2032,2033,2034,2032,2028,2028,2029,2030,2031,2034,2028,2029,2030,2034,2033,2034,2032,2033,2034,2033,2031,2032,2034,2029,2030,2032,2033,2034,2033,2031,2033,2034,2034,2033,2032,2033,2029,2030,2031,2032,2033,2034,2032,2033,2034,2033,2034,2033,2034,2029,2031,2032,2033,2034,2029,2029,2031,2029,2030,2031,2030,2032,2034,2031,2032,2033,2028,2029,2030,2034,2028,2029,2030,2031,2028,2033,2034,2030,2031,2032,2028,2030,2028,2029,2030,2034,2032,2033,2034,2032,2033,2034,2034,2031,2032,2029,2030,2031,2032,2033,2034,2028,2033,2034,2029,2034,2032,2033,2032,2033,2033,2028,2029,2030,2031,2032,2033,2031,2032,2033,2031,2032,2033,2034,2034,2032,2033],"weight":[22,22,37,21,29,43,21,23,39,35,32,23,21,28,29,40,28,23,48,54,29,27,49,57,133,47,48,28,25,34,29,23,30,42,25,36,25,24,33,28,27,21,21,22,44,25,24,42,52,123,133,157,156,24,36,29,23,51,45,22,24,21,32,24,23,30,23,36,22,51,32,33,38,24,59,28,42,22,75,55,23,30,38,24,22,35,53,23,32,40,55,61,70,24,26,59,75,74,50,21,57,74,62,22,28,31,42,48,93,21,41,21,23,26,65,22,46,39,26,23,30,33,28,22,40,30,23,61,80,40,28,148,75,80,37,25,53,86,138,25,34,187,220,223,25,22,35,22,24,22,28,21,36,81,29,26,58,58,24,24,28,63,61,31,24,80,97,32,98,68,29,37,77,87,22,23,22,36,26,51,30,27,34,41,34,28,40,47,56,104,130,21,21,53,25,22,56,72,26,22,31,180,179,160,68,48,66,79,62,33,21,92,83,79,78,53,36]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"layout":{"randomSeed":123}},"groups":["4","2","11","12","3","13","1","7","6","5","9","14","15","10","8","16","17","18","19"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>